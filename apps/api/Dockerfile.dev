# ============================================
#  API Dockerfile - Development
# ============================================

FROM node:20-alpine

# Instalar pnpm
RUN corepack enable && corepack prepare pnpm@latest --activate

# Criar diret贸rio de trabalho
WORKDIR /app

# Copiar arquivos de configura莽茫o do monorepo
COPY package.json pnpm-lock.yaml pnpm-workspace.yaml ./
COPY turbo.json ./

# Copiar package.json dos pacotes
COPY packages/shared-types/package.json ./packages/shared-types/
COPY packages/shared-utils/package.json ./packages/shared-utils/
COPY packages/eslint-config/package.json ./packages/eslint-config/

# Copiar package.json da API
COPY apps/api/package.json ./apps/api/

# Instalar depend锚ncias
RUN pnpm install

# Copiar c贸digo fonte dos pacotes compartilhados
COPY packages ./packages

# Copiar c贸digo fonte da API
COPY apps/api ./apps/api

# Definir diret贸rio de trabalho da API
WORKDIR /app/apps/api

# Expor porta
EXPOSE 3000

# Comando de desenvolvimento
CMD ["pnpm", "run", "start:dev"]
